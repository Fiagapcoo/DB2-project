{% load static %}

{% block extra_css %}
<!-- Adicione Bootstrap Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css">
<link rel="stylesheet" href="{% static 'filter_card/css/filter_card.css' %}">
<link rel="stylesheet" href="{% static '/css/filter_card.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/14.7.0/nouislider.min.css" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
{% endblock %}

{% block content %}
<div class="filter-card">
    <label for="marca">Marca</label>
    <select id="marca" class="form-select">
        <option>Selecione uma Marca</option>
        <option>Marca A</option>
        <option>Marca B</option>
    </select>

    <label for="modelo" class="mt-3">Modelo</label>
    <select id="modelo" class="form-select">
        <option>Selecione um Modelo</option>
        <option>Modelo X</option>
        <option>Modelo Y</option>
    </select>

    <label for="price-range" class="form-label">Preço</label>

    <!-- Div do slider de preço noUiSlider -->
    <div id="price-slider" class="mt-3" style="height: 10px;"></div>
    
    <!-- Exibição dos valores selecionados -->
    <div class="price-display mt-2">
        <input type="text" id="min-value" class="price-input" readonly>
        <span> - </span>
        <input type="text" id="max-value" class="price-input" readonly>
    </div>

    <label class="mt-3">Avaliação</label>
    <div class="rating-filter">
        <!-- Checkbox and rating for 4 stars -->
        <label class="rating-option">
            <input type="checkbox" name="rating" value="4" class="rating-checkbox">
            <span class="stars">
                <span class="star">★</span>
                <span class="star">★</span>
                <span class="star">★</span>
                <span class="star">★</span>
                <span class="star empty">★</span>
            </span>
            & Up
        </label>

        <!-- Checkbox and rating for 3 stars -->
        <label class="rating-option">
            <input type="checkbox" name="rating" value="3" class="rating-checkbox">
            <span class="stars">
                <span class="star">★</span>
                <span class="star">★</span>
                <span class="star">★</span>
                <span class="star empty">★</span>
                <span class="star empty">★</span>
            </span>
            & Up
        </label>

        <!-- Checkbox and rating for 2 stars -->
        <label class="rating-option">
            <input type="checkbox" name="rating" value="2" class="rating-checkbox">
            <span class="stars">
                <span class="star">★</span>
                <span class="star">★</span>
                <span class="star empty">★</span>
                <span class="star empty">★</span>
                <span class="star empty">★</span>
            </span>
            & Up
        </label>

        <!-- Checkbox and rating for 1 star -->
        <label class="rating-option">
            <input type="checkbox" name="rating" value="1" class="rating-checkbox">
            <span class="stars">
                <span class="star">★</span>
                <span class="star empty">★</span>
                <span class="star empty">★</span>
                <span class="star empty">★</span>
                <span class="star empty">★</span>
            </span>
            & Up
        </label>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/14.7.0/nouislider.min.js"></script>


<script>

// Selecionar as checkboxes de avaliação
const ratingCheckboxes = document.querySelectorAll(".rating-checkbox");

// Adicionar evento de clique em cada checkbox para garantir seleção exclusiva
ratingCheckboxes.forEach(checkbox => {
    checkbox.addEventListener("change", () => {
        // Se a checkbox foi marcada, desmarcar todas as outras
        if (checkbox.checked) {
            ratingCheckboxes.forEach(otherCheckbox => {
                if (otherCheckbox !== checkbox) {
                    otherCheckbox.checked = false;
                }
            });
        }
    });
});

document.addEventListener('DOMContentLoaded', function () {
    const priceSlider = document.getElementById('price-slider');

    if (priceSlider) {  // Verifica se o elemento existe
        noUiSlider.create(priceSlider, {
            start: [300, 1200], // Valores iniciais
            connect: true,
            range: {
                'min': 0,
                'max': 5000
            },
            format: {
                to: (value) => `${Math.round(value)}€`,
                from: (value) => Number(value.replace('€', ''))
            }
        });

        // Referências aos inputs de exibição
        const minValueDisplay = document.getElementById("min-value");
        const maxValueDisplay = document.getElementById("max-value");

        // Atualizar os valores exibidos quando o slider é movimentado
        priceSlider.noUiSlider.on('update', function (values) {
            minValueDisplay.value = values[0];
            maxValueDisplay.value = values[1];
        });
    }
});

</script>
{% endblock %}
